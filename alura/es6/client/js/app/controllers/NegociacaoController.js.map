{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","error","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","erro","importa","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus","coluna","inverteOrdem","ordena","a","b","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\r\nimport {Mensagem} from '../models/Mensagem';\r\nimport {NegociacoesView} from '../views/NegociacoesView';\r\nimport {MensagemView} from '../views/MensagemView';\r\nimport {NegociacaoService} from '../services/NegociacaoService';\r\nimport {DateHelper} from '../helpers/DateHelper';\r\nimport {Bind} from '../helpers/Bind';\r\nimport {Negociacao} from '../models/Negociacao';\r\n\r\nclass NegociacaoController {\r\n\r\n\tconstructor() {\r\n\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\r\n\t\tthis._inputData = $('#data');\r\n\t\tthis._inputQuantidade = $('#quantidade');\r\n\t\tthis._inputValor = $('#valor');\r\n\r\n\t\tthis._listaNegociacoes = new Bind(\r\n\t\t\tnew ListaNegociacoes(),\r\n\t\t\tnew NegociacoesView($('#negociacoesView')),\r\n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\r\n\r\n\t\tthis._mensagem = new Bind(\r\n\t\t\tnew Mensagem(),\r\n\t\t\tnew MensagemView($('#mensagemView')),\r\n\t\t\t'texto');\r\n\r\n\t\tthis._ordemAtual = '';\r\n\r\n\t\tthis._service = new NegociacaoService();\r\n\r\n\t\tthis._init();\r\n\t\t\r\n\t}\r\n\r\n\t_init() {\r\n\r\n\t\tthis._service\r\n\t\t\t.lista()\r\n\t\t\t.then(negociacoes => \r\n\t\t\t\tnegociacoes.forEach(negociacao => \r\n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\r\n\t\t\t.catch(erro => this._mensagem.texto = error);\r\n\r\n\t\tsetInterval(() => {\r\n\r\n\t\t\tthis.importaNegociacoes();\r\n\r\n\t\t}, 3000);\r\n\r\n\t}\r\n\r\n\tadiciona(event) {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tlet negociacao = this._criaNegociacao();\r\n\r\n\t\tthis._service\r\n\t\t\t.cadastra(negociacao)\r\n\t\t\t.then(mensagem => {\r\n\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._limpaFormulario();\r\n\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\r\n\t}\r\n\r\n\timportaNegociacoes() {\r\n\r\n\t\tthis._service\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n            .then(negociacoes => negociacoes.forEach(negociacao => {\r\n\r\n                this._listaNegociacoes.adiciona(negociacao);\r\n                this._mensagem.texto = 'Negociações do período importadas';   \r\n\r\n            }))\r\n            .catch(erro => this._mensagem.texto = erro);               \r\n    \r\n    }\r\n\r\n\tapaga() {\r\n\r\n\t\tthis._service\r\n\t\t\t.apaga()\r\n\t\t\t.then(mensagem => {\r\n\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._listaNegociacoes.esvazia();\r\n\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t\t\t\r\n\t}\r\n\r\n\t_criaNegociacao() {\r\n\r\n\t\treturn new Negociacao(\r\n\t\t\tDateHelper.textoParaData(this._inputData.value),\r\n\t\t\tparseInt(this._inputQuantidade.value),\r\n\t\t\tparseFloat(this._inputValor.value));\r\n\r\n\t}\r\n\r\n\t_limpaFormulario() {\r\n\r\n\t\tthis._inputData.value = '';\r\n\t\tthis._inputQuantidade.value = 1;\r\n\t\tthis._inputValor.value = 0.0;\r\n\t\tthis._inputData.focus();\r\n\t\t\r\n\t}\r\n\r\n\tordena(coluna) {\r\n        if(this._ordemAtual == coluna) {\r\n            this._listaNegociacoes.inverteOrdem();\r\n        } else {\r\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);    \r\n        }\r\n        this._ordemAtual = coluna;\r\n    }\r\n\r\n}\r\n\r\n\r\nlet negociacaoController = new NegociacaoController();\r\n\r\nexport function currentInstance() {\r\n\r\n\treturn negociacaoController;\r\n}"]}